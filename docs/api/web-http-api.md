---
type: REF
domain: web
title: "Web HTTP API"
audience: [developers, architects]
status: current
last_updated: 2025-10-09
framework_version: v0.6.3
validation:
  date_last_tested: 2025-10-09
  status: verified
  scope: docs/api/web-http-api.md
---

# Web HTTP API

## Contract

- Inputs: ASP.NET Core app with `builder.Services.AddKoan()` and entity models.
- Outputs: Controller-first HTTP APIs with CRUD, pagination, filters, transformers, and auth.
- Error modes: Missing controllers, conflicting routes, pagination misconfiguration, payload shape mismatches.
- Success criteria: Endpoints generated by `EntityController<T>` behave consistently; custom actions integrate with transformers and policies.

### Edge Cases

- Content negotiation: Verify default formatters and custom media types.
- Large datasets: Use `FirstPage`/`Page` or streaming endpoints; avoid unbounded lists.
- Auth defaults: Ensure providers configured before boot when required.
- Transformers: Keep projections consistent with client expectations; document view shapes.

---

## Controllers-first pattern

```csharp
[Route("api/[controller]")]
public class ProductsController : EntityController<Product> { }
```

- Automatic CRUD: GET/POST/PUT/PATCH/DELETE
- Pagination: Controlled via attributes and safety bounds
- Filters/sort: JSON filter language and defaults

## Transformers (WEB-0035)

Use transformers to shape responses without duplicating controllers.

```csharp
public sealed class ProductTransformer : IEntityTransformer<Product>
{
    public object Shape(Product p) => new { p.Id, p.Name, Price = p.Price.ToString("0.00") };
}
```

## Pagination behavior

- Prefer `PaginationAttribute` defaults for consistency.
- For large tables, expose explicit paging endpoints and set reasonable bounds.

## Error contracts

- All errors return structured problem details; hook validations should surface reason codes.

## Related

- Reference: `reference/web/index.md`, `reference/web/pagination-attribute.md`
- Guides: Building APIs, Performance Optimization
- ADR: WEB-0035 EntityController transformers